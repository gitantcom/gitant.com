
<h1 class="sectionedit1" id="任务分支模式">任务分支模式</h1>
<div class="level1">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-1.png" class="media" title="git_branch_model:git-workflow-feature-branch-1.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-1.png" class="mediacenter" alt="" /></a>
Once you&#039;ve got the hang of the Centralized Workflow, adding feature branches to your development process is an easy way to encourage collaboration and streamline communication between developers.
</p>

<p>
<span style="color: #0000EE">一旦熟悉了集中式的git开发流程，再使用特性分支开发就容易多了，并加强了协作性而且简便了沟通。
</span>
The core idea behind the Feature Branch Workflow is that all feature development should take place in a dedicated branch instead of the master branch. This encapsulation makes it easy for multiple developers to work on a particular feature without disturbing the main codebase. It also means the master branch will never contain broken code, which is a huge advantage for continuous integration environments.
</p>

<p>
<span style="color: #0000EE">特性分支流程的核心就是所有新需求都在分支上开发。大家都在不同的分支上开发，互相不干扰，主干（master)不会有无法编译的代码，持续集成就需要这种的特性。</span>
</p>

<p>
Encapsulating feature development also makes it possible to leverage pull requests, which are a way to initiate discussions around a branch. They give other developers the opportunity to sign off on a feature before it gets integrated into the official project. Or, if you get stuck in the middle of a feature, you can open a pull request asking for suggestions from your colleagues. The point is, pull requests make it incredibly easy for your team to comment on each other’s work.
</p>

<p>
<span style="color: #0000EE">每个需求都用分支来开发，这样就可以在分支上发起讨论，在分支合并入项目主库前，其他工程师也有机会广播这个特性。如果对这个需求你还有一些想法，你可以创建一个pull request咨询你的同事。 pull request 让其他开发者在合并代码前，评审代码。</span>
</p>

</div>
<!-- EDIT1 SECTION "任务分支模式" [1-1922] -->
<h2 class="sectionedit2" id="流程描述">流程描述</h2>
<div class="level2">

<p>
The Feature Branch Workflow still uses a central repository, and master still represents the official project history. But, instead of committing directly on their local master branch, developers create a new branch every time they start work on a new feature. Feature branches should have descriptive names, like animated-menu-items or issue-#1061. The idea is to give a clear, highly-focused purpose to each branch.
</p>

<p>
<span style="color: #0000EE">任务分支模式任然需要一个中央仓库，master分支存放的是稳定的生产版本。每当有新任务的时候，工程师在本地创建新分支。分支的名字应该能说清楚分支的目的。比如分支Issue-#1061。</span>
</p>

<p>
Git makes no technical distinction between the master branch and feature branches, so developers can edit, stage, and commit changes to a feature branch just as they did in the Centralized Workflow.
</p>

<p>
<span style="color: #0000EE">对于Git来说，master分支和任务分支在功能上没有什么不一样。 工程师在任务分支上的活动和在中央集中式的流程一样。</span>
</p>

<p>
In addition, feature branches can (and should) be pushed to the central repository. This makes it possible to share a feature with other developers without touching any official code. Since master is the only “special” branch, storing several feature branches on the central repository doesn’t pose any problems. Of course, this is also a convenient way to back up everybody’s local commits.
</p>

<p>
<span style="color: #0000EE">任务分支在本地每天提交后，也需要同步到中央仓库，其他工程师不用动稳定代码，就可以看到新功能的代码。作为本地的备份。</span>
</p>

</div>
<!-- EDIT2 SECTION "流程描述" [1923-3593] -->
<h3 class="sectionedit3" id="合并请求_pull_requests">合并请求(Pull Requests)</h3>
<div class="level3">

<p>
Aside from isolating feature development, branches make it possible to discuss changes via pull requests. Once someone completes a feature, they don’t immediately merge it into master. Instead, they push the feature branch to the central server and file a pull request asking to merge their additions into master. This gives other developers an opportunity to review the changes before they become a part of the main codebase.
</p>

<p>
<span style="color: #0000EE"> 除了孤立的特性开发，通过pull request 也使得讨论变更成为可能。一旦完成了某个任务， 你不能立即把它合并回主干。相反的，你发起一个合并请求，要求合并到主干上。这给了其他开发者有机会评审你的代码，然后才能合并回主干。</span>
</p>

<p>
Code review is a major benefit of pull requests, but they’re actually designed to be a generic way to talk about code. You can think of pull requests as a discussion dedicated to a particular branch. This means that they can also be used much earlier in the development process. For example, if a developer needs help with a particular feature, all they have to do is file a pull request. Interested parties will be notified automatically, and they’ll be able to see the question right next to the relevant commits.
</p>

<p>
<span style="color: #0000EE"> pull requests 的主要好处是代码评审。但它最初的应用是讨论代码。</span>
</p>

<p>
Once a pull request is accepted, the actual act of publishing a feature is much the same as in the Centralized Workflow. First, you need to make sure your local master is synchronized with the upstream master. Then, you merge the feature branch into master and push the updated master back to the central repository.
</p>

<p>
<span style="color: #0000EE"> 一旦pull reques 被接受了，提交代码的功能和中央集中式工作流程一样。</span>
</p>

<p>
Pull requests can be facilitated by product repository management solutions like Bitbucket or Stash. View the Stash pull requests documentation for an example.
</p>

<p>
<span style="color: #0000EE"> 对于一些git托管系统，pull request是非常有用的工具。</span>
</p>

</div>
<!-- EDIT3 SECTION "合并请求(Pull Requests)" [3594-5697] -->
<h2 class="sectionedit4" id="演示">演示</h2>
<div class="level2">

<p>
The example included below demonstrates a pull request as a form of code review, but remember that they can serve many other purposes.
</p>

<p>
本演示用pull request作为代码评审的形式之一，但要明白pull request 有很多用途。
</p>

</div>
<!-- EDIT4 SECTION "演示" [5698-5956] -->
<h3 class="sectionedit5" id="mary_开始新任务开发">Mary 开始新任务开发</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-2.png" class="media" title="git_branch_model:git-workflow-feature-branch-2.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-2.png" class="mediacenter" alt="" /></a>
Before she starts developing a feature, Mary needs an isolated branch to work on. She can request a new branch with the following command:
</p>

<p>
<span style="color: #0000EE"> Mary 首先创建一个新的任务分支：</span>
</p>
<pre class="code">git checkout -b marys-feature master</pre>

<p>
This checks out a branch called marys-feature based on master, and the -b flag tells Git to create the branch if it doesn’t already exist. On this branch, Mary edits, stages, and commits changes in the usual fashion, building up her feature with as many commits as necessary:
</p>

<p>
<span style="color: #0000EE"> 在这个分支，Mary完成开发工作。</span>
</p>
<pre class="code">git status
git add &lt;some-file&gt;
git commit</pre>

</div>
<!-- EDIT5 SECTION "Mary 开始新任务开发" [5957-6704] -->
<h3 class="sectionedit6" id="mary_要去午餐">Mary 要去午餐</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-3.png" class="media" title="git_branch_model:git-workflow-feature-branch-3.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-3.png" class="mediacenter" title="Git Workflows: Feature Commits" alt="Git Workflows: Feature Commits" /></a>
</p>

<p>
Mary adds a few commits to her feature over the course of the morning. Before she leaves for lunch, it’s a good idea to push her feature branch up to the central repository. This serves as a convenient backup, but if Mary was collaborating with other developers, this would also give them access to her initial commits.
</p>

<p>
<span style="color: #0000EE"> Mary 清晨开始了一些提交，午餐时，她最好能把任务分支提交到中央项目库。这也是一种备份方式。</span>
</p>
<pre class="code">git push -u origin marys-feature</pre>

<p>
This command pushes marys-feature to the central repository (origin), and the -u flag adds it as a remote tracking branch. After setting up the tracking branch, Mary can call git push without any parameters to push her feature.
</p>

<p>
<span style="color: #0000EE"> Mary利用这里命令在中央仓库创建了自己的分支。</span>
</p>

</div>
<!-- EDIT6 SECTION "Mary 要去午餐" [6705-7656] -->
<h3 class="sectionedit7" id="mary_的任务开发完成">Mary 的任务开发完成</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-4.png" class="media" title="git_branch_model:git-workflow-feature-branch-4.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-4.png" class="mediacenter" title="Git Workflows: Pull Request" alt="Git Workflows: Pull Request" /></a>
</p>

<p>
When Mary gets back from lunch, she completes her feature. Before merging it into master, she needs to file a pull request letting the rest of the team know she&#039;s done. But first, she should make sure the central repository has her most recent commits:
</p>

<p>
<span style="color: #0000EE"> 当Mary 午餐后，她完成了开发。为了让团队其他人了解她的工作，她先要向中央仓库分支提交代码： </span>
</p>
<pre class="code">git push</pre>

<p>
Then, she files the pull request in her Git <abbr title="Graphical User Interface">GUI</abbr> asking to merge marys-feature into master, and team members will be notified automatically. The great thing about pull requests is that they show comments right next to their related commits, so it&#039;s easy to ask questions about specific changesets.
</p>

<p>
<span style="color: #0000EE"> 然后，在她的Git工具中，发起一个pull request,要求合并她的代码到主干，团队其他成员也会自动收到提示。 pull request 的特点之一就是可以在相关提交里写下评语。所以对于某个代码片段可以容易地发起评审。</span>
</p>

</div>
<!-- EDIT7 SECTION "Mary 的任务开发完成" [7657-8802] -->
<h3 class="sectionedit8" id="bill_收到了合并请求">Bill 收到了合并请求</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-5.png" class="media" title="git_branch_model:git-workflow-feature-branch-5.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-5.png" class="mediacenter" title="
Git Workflows: Feature Pull Requests" alt="
Git Workflows: Feature Pull Requests" /></a>
</p>

<p>
Bill gets the pull request and takes a look at marys-feature. He decides he wants to make a few changes before integrating it into the official project, and he and Mary have some back-and-forth via the pull request.
</p>

<p>
<span style="color: #0000EE"> Bill收到合并请求，看到了Marry的分支。在合并Marry的代码前，Bill还要做一些变更，所以通过pull request和Marry做了一些沟通。</span>
</p>

</div>
<!-- EDIT8 SECTION "Bill 收到了合并请求" [8803-9332] -->
<h3 class="sectionedit9" id="mary_继续修改代码">Mary 继续修改代码</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-6.png" class="media" title="git_branch_model:git-workflow-feature-branch-6.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-6.png" class="mediacenter" title="Git Workflows: Central Repository Push" alt="Git Workflows: Central Repository Push" /></a>
</p>

<p>
To make the changes, Mary uses the exact same process as she did to create the first iteration of her feature. She edits, stages, commits, and pushes updates to the central repository. All her activity shows up in the pull request, and Bill can still make comments along the way.
</p>

<p>
<span style="color: #0000EE"> Mary 就像第一轮过程，重复执行了编码，git add，git commit，git push 的工作。把代码提交到中央项目库分支。她的所有的变更历史都体现在pull request里，Bill 任然继续在pull request里执行代码评审。</span>
</p>

<p>
If he wanted, Bill could pull marys-feature into his local repository and work on it on his own. Any commits he added would also show up in the pull request.
</p>

<p>
<span style="color: #0000EE"> 如果有必要，Bill会 pull mary的代码分支进入他本地仓库，基于其上，继续工作。当让，任何Bill增加的提交都会想在pull request上。</span>
</p>

</div>
<!-- EDIT9 SECTION "Mary 继续修改代码" [9333-10363] -->
<h3 class="sectionedit10" id="合并mary代码到中央项目库">合并Mary代码到中央项目库</h3>
<div class="level3">

<p>
<a href="/0/lib/exe/detail.php?id=git_branch_model%3Agit-feature-branch&amp;media=git_branch_model:git-workflow-feature-branch-7.png" class="media" title="git_branch_model:git-workflow-feature-branch-7.png"><img src="/0/lib/exe/fetch.php?media=git_branch_model:git-workflow-feature-branch-7.png" class="mediacenter" alt="" /></a>
Once Bill is ready to accept the pull request, someone needs to merge the feature into the stable project (this can be done by either Bill or Mary):
</p>

<p>
<span style="color: #0000EE"> 一旦Bill 决定接受pull request，就要有人去合并Mary的代码到稳定的中央项目仓库，（这个工作可以是Marry也可以是Bill来操作）</span>
</p>
<pre class="code">git checkout master
git pull
git pull origin marys-feature
git push</pre>

<p>
First, whoever’s performing the merge needs to check out their master branch and make sure it’s up to date. Then, git pull origin marys-feature merges the central repository’s copy of marys-feature. You could also use a simple git merge marys-feature, but the command shown above makes sure you’re always pulling the most up-to-date version of the feature branch. Finally, the updated master needs to get pushed back to origin.
</p>

<p>
This process often results in a merge commit. Some developers like this because it’s like a symbolic joining of the feature with the rest of the code base. But, if you’re partial to a linear history, it’s possible to rebase the feature onto the tip of master before executing the merge, resulting in a fast-forward merge.
</p>

<p>
Some GUI’s will automate the pull request acceptance process by running all of these commands just by clicking an “Accept” button. If yours doesn’t, it should at least be able to automatically close the pull request when the feature branch gets merged into master
</p>

</div>
<!-- EDIT10 SECTION "合并Mary代码到中央项目库" [10364-11919] -->
<h3 class="sectionedit11" id="期间_john_也要同步代码">期间, John 也要同步代码</h3>
<div class="level3">

<p>
While Mary and Bill are working on marys-feature and discussing it in her pull request, John is doing the exact same thing with his own feature branch. By isolating features into separate branches, everybody can work independently, yet it’s still trivial to share changes with other developers when necessary.
</p>

</div>
<!-- EDIT11 SECTION "期间, John 也要同步代码" [11920-12272] -->
<h2 class="sectionedit12" id="where_to_go_from_here">Where To Go From Here</h2>
<div class="level2">

<p>
By now, you can hopefully see how feature branches are a way to quite literally multiply the functionality of the single master branch used in the Centralized Workflow. In addition, feature branches also facilitate pull requests, which makes it possible to discuss specific commits right inside of your version control <abbr title="Graphical User Interface">GUI</abbr>.
</p>

<p>
The Feature Branch Workflow is an incredibly flexible way to develop a project. The problem is, sometimes it’s too flexible. For larger teams, it’s often beneficial to assign more specific roles to different branches. The Gitflow Workflow is a common pattern for managing feature development, release preparation, and maintenance.
</p>

</div>
<!-- EDIT12 SECTION "Where To Go From Here" [12273-] -->