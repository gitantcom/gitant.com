======Gitflow Workflow======
{{ :git_branch_model:git-workflow-gitflow.png?300 |}}
The Gitflow Workflow section below is derived from Vincent Driessen at nvie. 



The Gitflow Workflow defines a strict branching model designed around the project release. While somewhat more complicated than the Feature Branch Workflow, this provides a robust framework for managing larger projects.

<fc #0000EE>Gitflow 围绕发布定义了严格的分支模式。比任务分支模式更复杂，但对于管理大型项目提供了强壮的框架。</fc>

This workflow doesn’t add any new concepts or commands beyond what’s required for the Feature Branch Workflow. Instead, it assigns very specific roles to different branches and defines how and when they should interact. In addition to feature branches, it uses individual branches for preparing, maintaining, and recording releases. Of course, you also get to leverage all the benefits of the Feature Branch Workflow: pull requests, isolated experiments, and more efficient collaboration.

<fc #0000EE>相对于任务分支，gitflow没有增加新的概念，它只是分配了许多特殊角色的分支，定义了什么时间和如何交互。 这些分支分别用来开发、维护、发布等。你也可以利用任务分支的所有其他好处，pull request、隔离开发、有效协作等。</fc>


=====流程介绍=====

The Gitflow Workflow still uses a central repository as the communication hub for all developers. And, as in the other workflows, developers work locally and push branches to the central repo. The only difference is the branch structure of the project.



<fc #0000EE>Gitflow 依然使用一个中央仓库作为所有团队成员的项目库。而且同其他工作流程一样，开发者依然在本地开发，并提交分支到中央仓库。和任务分支模式主要的不同是分支在项目中的布局不同。</fc>
====产品历史分支====

Instead of a single master branch, this workflow uses two branches to record the history of the project. The master branch stores the official release history, and the develop branch serves as an integration branch for features. It's also convenient to tag all commits in the master branch with a version number.

<fc #0000EE>相对于项目库中的单个master分支，gitflows用两个分支来记录项目历史。 master分支记录项目的正式发布历史，开发分支用于集成各种功能。在master主分支上很便利的对特殊版本号贴上标签。</fc>

{{ :git_branch_model:git-workflow-release-cycle-1historical.png |}}
The rest of this workflow revolves around the distinction between these two branches.

<fc #0000EE>此工作流的其余部分围绕着这两个分支差异展开。</fc>

====任务分支Feature Branches====


Each new feature should reside in its own branch, which can be pushed to the central repository for backup/collaboration. But, instead of branching off of master, feature branches use develop as their parent branch. When a feature is complete, it gets merged back into develop. Features should never interact directly with master.

<fc #0000EE>每一个任务分支都在本地，这些分支也需要提交到中央项目仓库用于备份和协作。但是，相对于从主干master上开出分支，gitflow中的任务分支是从开发分支(develop）上创建的。当任务完成后，分支合并回开发分支(develop).任务分支从不直接和主干(master）打交道。</fc>

{{ :git_branch_model:git-workflow-release-cycle-2feature.png |}}
Note that feature branches combined with the develop branch is, for all intents and purposes, the Feature Branch Workflow. But, the Gitflow Workflow doesn’t stop there.

<fc #0000EE>任务分支结合开发分支，就可以满足对于各种开发用途，gitflow还不止这些功能。</fc>

====发布分支（Release Branches）====
{{ :git_branch_model:git-workflow-release-cycle-3release.png |}}
Once develop has acquired enough features for a release (or a predetermined release date is approaching), you fork a release branch off of develop. Creating this branch starts the next release cycle, so no new features can be added after this point—only bug fixes, documentation generation, and other release-oriented tasks should go in this branch. Once it's ready to ship, the release gets merged into master and tagged with a version number. In addition, it should be merged back into develop, which may have progressed since the release was initiated.

<fc #0000EE>当代码逐渐成熟，准备发布的时候。你就需要从开发分支上开出一个发布分支。这也就意味着你进入下一个发布周期。在这以后，发布分支不接受新的功能代码的合并，只合并缺陷修复的代码，文档修改和其他面向发布的任务。如果准备发布，发布分支就合并到master主分支，并贴上标签。另外，发布分支也要合并回开发分支. </fc>

Using a dedicated branch to prepare releases makes it possible for one team to polish the current release while another team continues working on features for the next release. It also creates well-defined phases of development (e.g., it's easy to say, “this week we're preparing for version 4.0” and to actually see it in the structure of the repository).

Common conventions:

    branch off: develop
    merge into: master
    naming convention: release-* or release/*



====维护分支（Maintenance Branches）====
{{ :git_branch_model:git-workflow-release-cycle-4maintenance.png |}}
Maintenance or “hotfix” branches are used to quickly patch production releases. This is the only branch that should fork directly off of master. As soon as the fix is complete, it should be merged into both master and develop (or the current release branch), and master should be tagged with an updated version number.

<fc #0000EE>维护分支，或者叫"hotfix”分支用于快速补丁产品发布分支。这是唯一直接从master分支上开出的分支。一旦修复完成，代码应合并回master主干和develop分支（或者当前发布分支），master分支上也要贴一个标签。</fc>

Having a dedicated line of development for bug fixes lets your team address issues without interrupting the rest of the workflow or waiting for the next release cycle. You can think of maintenance branches as ad hoc release branches that work directly with master.

<fc #0000EE>独立的维护分支的出现，可以让团队成员无需中断发布流程，或者必须等在下次发布修复缺陷。维护分支是直接从master分支上直接开出用于紧急修复的发布分支。 </fc>


=====实例演示=====

The example below demonstrates how this workflow can be used to manage a single release cycle. We’ll assume you have already created a central repository.


====创建开发分支====  
{{ :git_branch_model:git-workflow-release-cycle-5createdev.png |}}
The first step is to complement the default master with a develop branch. A simple way to do this is for one developer to create an empty develop branch locally and push it to the server:  

<fc #0000EE>第一步，从master上创建开发分支。简单的方法是，在本地创建一个空分支，然后提交到中央项目仓库：</fc>

<code>
git branch develop
git push -u origin develop
</code>

This branch will contain the complete history of the project, whereas master will contain an abridged version. Other developers should now clone the central repository and create a tracking branch for develop:

<fc #0000EE>这个分支包含了项目完整的开发历史，master主干分支包含的是重要节点版本历史。其余分支都是从开发分支中创建出来的。</fc>


<code>
git clone ssh://user@host/path/to/repo.git
git checkout -b develop origin/develop
</code>
Everybody now has a local copy of the historical branches set up.   
   
====Mary 和 John 开发新功能====
 {{ :git_branch_model:git-workflow-release-cycle-6maryjohnbeginnew.png |}} 
Our example starts with John and Mary working on separate features. They both need to create separate branches for their respective features. Instead of basing it on master, they should both base their feature branches on develop:
<code>
git checkout -b some-feature develop
</code>
Both of them add commits to the feature branch in the usual fashion: edit, stage, commit:
<code>
git status
git add <some-file>
git commit
</code>

====Mary 完成任务开发====
{{ :git_branch_model:git-workflow-release-cycle-7maryfinishes.png |}}
After adding a few commits, Mary decides her feature is ready. If her team is using pull requests, this would be an appropriate time to open one asking to merge her feature into develop. Otherwise, she can merge it into her local develop and push it to the central repository, like so:


<fc #0000EE>Mary完成了开发任务。如果她使用pull request，需要评审然后合并到开发分支。否则，她合并任务分支进入本地的开发分支，然后推送到远端中央项目库：</fc>
<code>
git pull origin develop
git checkout develop
git merge some-feature
git push
git branch -d some-feature
</code>

The first command makes sure the develop branch is up to date before trying to merge in the feature. Note that features should never be merged directly into master. Conflicts can be resolved in the same way as in the Centralized Workflow.


====Mary开始计划发布产品====
{{ :git_branch_model:git-workflow-release-cycle-8maryprepsrelease.png |}}
While John is still working on his feature, Mary starts to prepare the first official release of the project. Like feature development, she uses a new branch to encapsulate the release preparations. This step is also where the release’s version number is established:

<fc #0000EE>John继续开发他的代码，Mary开始准备她的第一次项目发布。她用一个新分支专门用来发布。这一步也确立的发布产品的版本号：</fc>

<code>
git checkout -b release-0.1 develop
</code>

This branch is a place to clean up the release, test everything, update the documentation, and do any other kind of preparation for the upcoming release. It’s like a feature branch dedicated to polishing the release.

As soon as Mary creates this branch and pushes it to the central repository, the release is feature-frozen. Any functionality that isn’t already in develop is postponed until the next release cycle.


====Mary 完成发布====
{{ :git_branch_model:git-workflow-release-cycle-9maryfinishes.png |}}
Once the release is ready to ship, Mary merges it into master and develop, then deletes the release branch. It’s important to merge back into develop because critical updates may have been added to the release branch and they need to be accessible to new features. Again, if Mary’s organization stresses code review, this would be an ideal place for a pull request.

<fc #0000EE>一旦产品发布准备完毕，Mary合并发布分支到主干分支（master）和开发分支（develop），然后删除发布分支。</fc>

<code>
git checkout master
git merge release-0.1
git push
git checkout develop
git merge release-0.1
git push
git branch -d release-0.1
</code>
Release branches act as a buffer between feature development (develop) and public releases (master). Whenever you merge something into master, you should tag the commit for easy reference:
<code>
git tag -a 0.1 -m "Initial public release" master
git push --tags
</code>
Git comes with several hooks, which are scripts that execute whenever a particular event occurs within a repository. It’s possible to configure a hook to automatically build a public release whenever you push the master branch to the central repository or push a tag.


====用户发现bug====
{{ :git_branch_model:git-workflow-gitflow-enduserbug.png |}}

After shipping the release, Mary goes back to developing features for the next release with John. That is, until an end-user opens a ticket complaining about a bug in the current release. To address the bug, Mary (or John) creates a maintenance branch off of master, fixes the issue with as many commits as necessary, then merges it directly back into master.


<fc #0000EE>产品发布后，Mary返回继续开发新的任务，为下次发布准备。如果用户报告了缺陷，需要从master创建维护分支，修复问题后，直接合并回master分支。</fc>

<code>
git checkout -b issue-#001 master
# Fix the bug
git checkout master
git merge issue-#001
git push
</code>
Like release branches, maintenance branches contain important updates that need to be included in develop, so Mary needs to perform that merge as well. Then, she’s free to delete the branch:

<fc #0000EE>就像发布分支，维护分支包含了重要的代码修复，同样需要合并回开发分支，所有Mary需要执行合并，完事后，删除任务维护分支。</fc>
<code>
git checkout develop
git merge issue-#001
git push
git branch -d issue-#001
</code>

=====Where To Go From Here=====

By now, you’re hopefully quite comfortable with the Centralized Workflow, the Feature Branch Workflow, and the Gitflow Workflow. You should also have a solid grasp on the potential of local repositories, the push/pull pattern, and Git's robust branching and merging model.

Remember that the workflows presented here are merely examples of what’s possible—they are not hard-and-fast rules for using Git in the workplace. So, don't be afraid to adopt some aspects of a workflow and disregard others. The goal should always be to make Git work for you, not the other way around.












